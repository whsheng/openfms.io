# Changelog

所有版本的变更记录。

格式基于 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [Semantic Versioning](https://semver.org/lang/zh-CN/)。

---

## [v1.2.0] - 2026-02-04

### 新增功能

#### 视频服务 (JT1078)
- JT1078 音视频协议支持
- ZLMediaKit 流媒体服务器集成
- 实时视频播放 (WebSocket-FLV/WebRTC/HLS)
- 历史视频回放
- 视频截图功能
- 录像管理和自动清理
- 多通道支持 (1-8通道)
- 设备视频配置

#### 报表统计
- 里程报表 (日/周/月统计)
- 停车报表 (停留点分析)
- 报警统计分析
- 驾驶行为分析 (急加速/急刹车/超速)
- 仪表盘数据汇总
- 数据可视化图表 (Recharts)
- 报表导出功能

#### 多协议适配
- GT06 协议适配器
- Wialon IPS 协议适配器
- 协议自动识别
- 统一数据模型转换

#### 系统监控
- Prometheus 指标采集
- Grafana 可视化仪表盘
- 主机监控 (Node Exporter)
- 容器监控 (cAdvisor)
- 应用指标暴露

### 技术改进
- 视频流旁路设计，不经过Go网关
- 新增报表统计定时任务
- 多协议自动识别和适配
- 完整的监控体系

### 文档
- 新增 JT1078 协议规范文档
- 新增 v1.2 开发总结文档
- 更新 Docker Compose 配置

---

## [v1.1.0] - 2026-02-04

### 新增功能

#### 地图集成与实时监控
- 集成 Mapbox GL JS 地图引擎
- 车辆位置标记（自定义图标 + 方向指示）
- 车辆平滑移动动画
- 点击车辆弹出信息卡片
- 地图控件（缩放、全屏、定位、比例尺）
- 矢量/卫星地图切换
- WebSocket 实时位置推送

#### 电子围栏功能
- 圆形围栏创建（地图点击选中心点 + 半径）
- 多边形围栏创建（地图点击绘制顶点）
- 围栏 CRUD 操作
- 设备绑定/解绑围栏
- 实时进出围栏检测（Haversine 公式 + 射线法）
- 围栏事件记录和报警

#### 报警中心
- 多种报警类型：围栏进出、超速、离线、低电量、SOS、断电等
- 报警级别：严重、警告、信息
- 报警状态管理：未读、已读、已处理
- 实时报警接收（WebSocket 推送）
- 报警列表（筛选、分页、批量操作）
- 报警统计（处理率、状态分布、级别分布）
- 报警规则配置
- 声音提醒和通知弹窗

#### RBAC 用户权限系统
- 角色管理（CRUD）
- 权限管理（分组展示）
- 用户管理（CRUD、分配角色）
- 权限中间件（RequirePermission、RequireAnyPermission、RequireAllPermissions）
- 超级管理员自动绕过权限检查
- 前端权限控制（菜单显示、按钮控制）

### 系统角色
- 超级管理员 (super_admin) - 拥有所有权限
- 管理员 (admin) - 除角色管理外的所有权限
- 操作员 (operator) - 日常操作权限
- 观察员 (viewer) - 只读权限

### 技术改进
- 新增 WebSocket 实时推送服务
- 新增权限中间件
- 数据库新增围栏、报警、RBAC 相关表
- 前端新增 TypeScript 类型定义

### 文档
- 新增 v1.1 开发总结文档
- 更新 README 功能列表
- 更新 ROADMAP 进度

---

## [v1.0.0] - 2026-02-02

### 初始版本

#### 核心功能
- 设备网关服务（Go TCP Server）
- JT808 协议解析和编码
- 设备管理（CRUD）
- 实时位置查询
- 历史轨迹查询
- JWT 用户认证
- Docker Compose 一键部署

#### 技术栈
- 后端：Go + Gin + GORM
- 前端：React 18 + Ant Design 5 + Vite
- 数据库：TimescaleDB (PostgreSQL)
- 缓存：Redis
- 消息队列：NATS
