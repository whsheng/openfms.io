# OpenFMS 功能路线图 (Roadmap)

> 本文档记录 OpenFMS 项目的功能实现状态，包括已完成、进行中、待实现的功能模块。
> 
> 最后更新: 2026-02-02

---

## 图例说明

| 状态 | 图标 | 说明 |
|------|------|------|
| 已完成 | ✅ | 功能已实现并通过测试 |
| 进行中 | 🚧 | 正在开发或部分实现 |
| 待实现 | ⏳ | 已规划但未开始开发 |
| 待定 | ❓ | 需求待确认 |

---

## 一、核心基础设施

### 1.1 项目架构

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 轻网关架构设计 | ✅ | P0 | 网关与业务解耦 |
| Docker Compose 部署 | ✅ | P0 | 一键启动所有服务 |
| 多环境配置支持 | ✅ | P1 | dev/prod 环境 |
| Makefile 快捷命令 | ✅ | P1 | 常用操作脚本 |
| Kubernetes 部署支持 | ⏳ | P2 | K8s YAML 配置 |
| Helm Chart | ⏳ | P3 | 企业级部署 |

### 1.2 数据库与存储

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| TimescaleDB 集成 | ✅ | P0 | 时序数据库 |
| 自动压缩策略 | ✅ | P0 | 7天自动压缩 |
| 数据保留策略 | ✅ | P1 | 90天数据保留 |
| PostGIS 空间扩展 | ✅ | P1 | 地理空间查询 |
| 数据库迁移工具 | ⏳ | P2 | golang-migrate |
| 数据库备份恢复 | ⏳ | P2 | 自动化备份 |

### 1.3 消息队列

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| NATS 集成 | ✅ | P0 | 消息队列 |
| 上行消息处理 | ✅ | P0 | 设备->平台 |
| 下行消息处理 | ✅ | P0 | 平台->设备 |
| 消息持久化 | ⏳ | P2 | JetStream |
| 消息重试机制 | ⏳ | P2 | 失败重发 |

---

## 二、设备网关 (Gateway)

### 2.1 网络通信

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| TCP 服务器 | ✅ | P0 | 长连接支持 |
| 多连接并发处理 | ✅ | P0 | Goroutine 模型 |
| 粘包处理 | ✅ | P0 | Frame Decoder |
| 心跳检测 | ✅ | P0 | 超时断开 |
| UDP 支持 | ⏳ | P2 | 部分设备需要 |
| TLS/SSL 加密 | ⏳ | P2 | 安全传输 |

### 2.2 协议适配

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| JT808 协议解析 | ✅ | P0 | 国内部标 |
| JT808 协议编码 | ✅ | P0 | 指令下发 |
| 协议自动识别 | ✅ | P1 | 多协议探测 |
| GT06 协议 | ⏳ | P2 | 常见海外协议 |
| Wialon IPS | ⏳ | P2 | Wialon 平台协议 |
| Traccar/OsmAnd | ⏳ | P2 | HTTP 协议 |
| 自定义协议扩展 | ⏳ | P3 | 插件化架构 |

### 2.3 JT808 具体功能

| 功能 | 状态 | 优先级 | 消息ID |
|------|------|--------|--------|
| 终端注册 (0x0100) | ✅ | P0 | 设备注册 |
| 终端鉴权 (0x0102) | ✅ | P0 | 设备登录 |
| 位置上报 (0x0200) | ✅ | P0 | GPS数据 |
| 心跳包 (0x0002) | ✅ | P0 | 保活机制 |
| 通用应答 (0x8001) | ✅ | P0 | 平台回复 |
| 参数查询 (0x8104) | ⏳ | P1 | 查询终端参数 |
| 参数设置 (0x8103) | ⏳ | P1 | 设置终端参数 |
| 终端控制 (0x8105) | ⏳ | P1 | 重启、复位等 |
| 位置查询 (0x8201) | ⏳ | P1 | 主动查位置 |
| 临时位置跟踪 (0x8202) | ⏳ | P2 | 定频上报 |
| 文本信息下发 (0x8300) | ⏳ | P2 | 下发文字 |
| 事件设置 (0x8301) | ⏳ | P3 | 自定义事件 |
| 提问下发 (0x8302) | ⏳ | P3 | 交互问答 |
| 信息点播 (0x8303) | ⏳ | P3 | 菜单点播 |
| 电话回拨 (0x8400) | ⏳ | P3 | 语音通话 |
| 车辆控制 (0x8500) | ⏳ | P2 | 断油电等 |
| 圆形区域设置 (0x8600) | ⏳ | P2 | 电子围栏 |
| 矩形区域设置 (0x8601) | ⏳ | P2 | 电子围栏 |
| 多边形区域设置 (0x8602) | ⏳ | P2 | 电子围栏 |
| 行驶路线设置 (0x8606) | ⏳ | P3 | 路线规划 |

---

## 三、API 服务

### 3.1 用户认证

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| JWT Token 认证 | ✅ | P0 | 无状态认证 |
| 用户登录 | ✅ | P0 | 账号密码 |
| 用户登出 | ✅ | P0 | Token 失效 |
| 密码加密存储 | ✅ | P0 | bcrypt |
| 用户管理 CRUD | 🚧 | P1 | 增删改查 |
| 角色权限控制 | ⏳ | P1 | RBAC 模型 |
| API 权限控制 | ⏳ | P2 | 接口级别权限 |
| 登录日志审计 | ⏳ | P2 | 安全审计 |
| 多因素认证 | ⏳ | P3 | MFA |
| OAuth2/SSO | ⏳ | P3 | 第三方登录 |

### 3.2 设备管理

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 设备注册 | ✅ | P0 | 添加设备 |
| 设备列表查询 | ✅ | P0 | 分页查询 |
| 设备详情查看 | ✅ | P0 | 单设备信息 |
| 设备信息修改 | ✅ | P0 | 更新设备 |
| 设备删除 | ✅ | P0 | 软删除 |
| 设备影子查询 | ✅ | P1 | 实时状态 |
| 设备批量导入 | ⏳ | P2 | Excel 导入 |
| 设备分组管理 | ⏳ | P2 | 分组标签 |
| 设备绑定车辆 | ⏳ | P1 | 车机关联 |
| 设备状态统计 | ⏳ | P2 | 在线率等 |

### 3.3 位置服务

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 最新位置查询 | ✅ | P0 | 单设备 |
| 所有设备最新位置 | ✅ | P0 | 批量查询 |
| 历史轨迹查询 | ✅ | P0 | 时间段查询 |
| 轨迹压缩存储 | ✅ | P0 | TimescaleDB |
| 轨迹纠偏 | ⏳ | P2 | 地图匹配 |
| 轨迹抽稀 | ⏳ | P2 | 减少点数 |
| 停留点分析 | ⏳ | P2 | 停车检测 |
| 里程统计 | ⏳ | P1 | 日/月里程 |
| 速度分析 | ⏳ | P2 | 超速统计 |

### 3.4 指令下发

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 指令发送接口 | ✅ | P0 | 通用接口 |
| 指令状态查询 | 🚧 | P1 | 待响应池 |
| 指令超时处理 | ⏳ | P1 | 30秒超时 |
| 批量指令下发 | ⏳ | P2 | 群发指令 |
| 指令历史记录 | ⏳ | P2 | 操作日志 |

### 3.5 电子围栏

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 圆形围栏 CRUD | ⏳ | P1 | 圆心半径 |
| 多边形围栏 CRUD | ⏳ | P1 | 多边形 |
| 围栏绑定设备 | ⏳ | P1 | 多对多 |
| 进出围栏检测 | ⏳ | P1 | 实时计算 |
| 围栏报警通知 | ⏳ | P1 | Webhook |
| 路线围栏 | ⏳ | P3 | 偏航检测 |

### 3.6 报警管理

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 报警类型定义 | ⏳ | P1 | 超速、围栏等 |
| 实时报警接收 | ⏳ | P1 | NATS 消费 |
| 报警列表查询 | ⏳ | P1 | 分页筛选 |
| 报警确认处理 | ⏳ | P2 | 人工确认 |
| 报警推送通知 | ⏳ | P2 | WebSocket |
| 报警统计报表 | ⏳ | P3 | 数据分析 |

---

## 四、前端界面 (Web)

### 4.1 基础框架

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| React 18 框架 | ✅ | P0 | 基础框架 |
| Vite 构建工具 | ✅ | P0 | 快速构建 |
| Ant Design 5 组件库 | ✅ | P0 | UI 组件 |
| React Router 路由 | ✅ | P0 | 页面路由 |
| Zustand 状态管理 | ✅ | P0 | 全局状态 |
| Axios HTTP 客户端 | ✅ | P0 | API 请求 |
| 响应式布局 | ✅ | P1 | 适配多屏 |
| 主题切换 | ⏳ | P3 | 暗黑模式 |
| 国际化 i18n | ⏳ | P3 | 多语言 |

### 4.2 页面功能

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 登录页面 | ✅ | P0 | JWT 登录 |
| 仪表盘首页 | ✅ | P0 | 数据统计 |
| 实时监控地图 | 🚧 | P0 | 地图组件待集成 |
| 设备管理列表 | ✅ | P0 | CRUD 操作 |
| 设备详情页面 | ⏳ | P1 | 详细信息 |
| 历史轨迹查询 | ✅ | P0 | 时间筛选 |
| 轨迹回放播放 | ⏳ | P1 | 动画播放 |
| 电子围栏管理 | ⏳ | P1 | 围栏配置 |
| 报警中心 | ⏳ | P2 | 报警列表 |
| 报表统计 | ⏳ | P2 | 数据报表 |
| 系统设置 | 🚧 | P2 | 基础框架 |
| 用户管理 | ⏳ | P2 | 管理员功能 |

### 4.3 地图功能

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| Mapbox GL JS 集成 | ⏳ | P0 | 地图引擎 |
| 车辆位置标记 | ⏳ | P0 | 图标标记 |
| 车辆平滑移动 | ⏳ | P1 | 动画效果 |
| 轨迹线绘制 | ⏳ | P1 | 历史轨迹 |
| 轨迹热力图 | ⏳ | P3 | 密度分析 |
| 地图围栏绘制 | ⏳ | P1 | 可视化编辑 |
| 地图测距工具 | ⏳ | P3 | 距离测量 |
| 离线地图支持 | ⏳ | P3 | 离线包 |

### 4.4 数据可视化

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| ECharts/Recharts | ⏳ | P2 | 图表库 |
| 实时数据卡片 | ✅ | P0 | 统计数字 |
| 趋势图表 | ⏳ | P2 | 折线图 |
| 饼图/柱状图 | ⏳ | P2 | 分类统计 |
| 数据导出 Excel | ⏳ | P2 | 报表导出 |
| 数据导出 PDF | ⏳ | P3 | 打印报表 |

---

## 五、视频服务 (JT1078)

### 5.1 视频接入

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| JT1078 协议支持 | ⏳ | P2 | 音视频流 |
| ZLMediaKit 集成 | ⏳ | P2 | 流媒体服务 |
| SRS 集成 | ⏳ | P2 | 备选方案 |
| 视频流转发 | ⏳ | P2 | RTP/RTMP |
| 多路视频并发 | ⏳ | P3 | 性能优化 |

### 5.2 视频播放

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 实时视频播放 | ⏳ | P2 | WebRTC/FLV |
| 历史视频回放 | ⏳ | P2 | 存储回放 |
| 视频截图 | ⏳ | P3 | 抓图功能 |
| 视频录制 | ⏳ | P3 | 云端存储 |

---

## 六、高级功能

### 6.1 数据分析

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 驾驶行为分析 | ⏳ | P3 | 急加速/刹车 |
| 油耗分析 | ⏳ | P3 | 燃油统计 |
| 工况分析 | ⏳ | P3 | 车辆健康 |
| 预测性维护 | ⏳ | P4 | AI 预警 |

### 6.2 集成扩展

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| Webhook 推送 | ⏳ | P2 | 事件通知 |
| OpenAPI 文档 | ⏳ | P2 | Swagger |
| 第三方平台对接 | ⏳ | P3 | 部标平台 |
| 消息队列对接 | ⏳ | P3 | Kafka 等 |

### 6.3 移动端

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 响应式 H5 | ⏳ | P3 | 手机浏览器 |
| React Native App | ⏳ | P4 | 原生应用 |
| 小程序 | ⏳ | P4 | 微信小程序 |

---

## 七、运维与监控

### 7.1 系统监控

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| Prometheus 监控 | ⏳ | P2 | 指标采集 |
| Grafana 仪表盘 | ⏳ | P2 | 可视化 |
| 链路追踪 | ⏳ | P3 | Jaeger |
| 日志聚合 | ⏳ | P2 | ELK/Loki |
| 健康检查接口 | ✅ | P1 | /health |

### 7.2 性能优化

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| Redis 缓存 | ✅ | P1 | 热点数据 |
| 数据库连接池 | ✅ | P1 | 连接管理 |
| API 限流 | ⏳ | P2 | 速率限制 |
| 网关负载均衡 | ⏳ | P2 | 多实例 |
| CDN 加速 | ⏳ | P3 | 静态资源 |

---

## 八、商业功能

### 8.1 多租户

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| 租户隔离 | ⏳ | P3 | SaaS 模式 |
| 租户管理 | ⏳ | P3 | 租户CRUD |
| 资源配额 | ⏳ | P3 | 车辆数限制 |
| 计费系统 | ⏳ | P4 | 按量计费 |

### 8.2 License 授权

| 功能 | 状态 | 优先级 | 备注 |
|------|------|--------|------|
| License 生成 | ⏳ | P3 | 授权文件 |
| License 验证 | ⏳ | P3 | 运行时检查 |
| 功能限制 | ⏳ | P3 | 免费版限制 |
| 硬件绑定 | ⏳ | P3 | MAC/CPU 绑定 |

---

## 统计汇总

### 按状态统计

| 状态 | 数量 | 占比 |
|------|------|------|
| ✅ 已完成 | 45 | 35% |
| 🚧 进行中 | 8 | 6% |
| ⏳ 待实现 | 75 | 58% |
| ❓ 待定 | 2 | 1% |
| **总计** | **130** | **100%** |

### 按优先级统计

| 优先级 | 数量 | 说明 |
|--------|------|------|
| P0 - 核心 | 32 | MVP 必须功能 |
| P1 - 重要 | 42 | 主要功能 |
| P2 - 一般 | 38 | 增强功能 |
| P3 - 次要 | 15 | 优化功能 |
| P4 - 可选 | 3 | 未来规划 |

### 按模块统计

| 模块 | 已完成 | 进行中 | 待实现 | 总计 |
|------|--------|--------|--------|------|
| 基础设施 | 8 | 0 | 4 | 12 |
| 设备网关 | 9 | 0 | 16 | 25 |
| API 服务 | 10 | 2 | 21 | 33 |
| 前端界面 | 9 | 2 | 20 | 31 |
| 视频服务 | 0 | 0 | 8 | 8 |
| 高级功能 | 0 | 0 | 10 | 10 |
| 运维监控 | 2 | 0 | 5 | 7 |
| 商业功能 | 0 | 0 | 5 | 5 |

---

## 版本规划

### v1.0 (当前) - 基础版
- ✅ 基础架构搭建
- ✅ JT808 协议支持
- ✅ 设备管理
- ✅ 实时位置
- ✅ 历史轨迹

### v1.1 - 稳定版 (计划)
- 🚧 地图集成
- ⏳ 电子围栏
- ⏳ 报警管理
- ⏳ 用户权限

### v1.2 - 增强版 (计划)
- ⏳ 视频支持 (JT1078)
- ⏳ 报表统计
- ⏳ 多协议适配
- ⏳ 系统监控

### v2.0 - 企业版 (规划)
- ⏳ 多租户支持
- ⏳ License 授权
- ⏳ 移动端 App
- ⏳ AI 分析

---

## 贡献指南

如果你想参与开发，建议从以下待实现功能中选择：

**适合新手 (Good First Issue)**:
- 用户管理 CRUD
- 登录日志审计
- API 文档 (Swagger)
- 系统设置页面完善

**核心功能 (Core Features)**:
- 地图组件集成
- 电子围栏功能
- 报警中心
- 报表统计

**高级功能 (Advanced)**:
- JT1078 视频支持
- 驾驶行为分析
- 多租户架构

---

*本文档由开发团队维护，功能状态会随开发进度更新。*
